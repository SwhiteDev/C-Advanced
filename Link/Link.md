# 对于链接的思考

                      静态链接       750Kb              506Kb
                  ________________> libc.a         产生：a.out             
      1Kb        /
    hello.o ----|                   
                 \________________> libc.so------->产生：a.out        
                      动态链接       620Kb               5Kb
                                                  库函数在运行时被映射到进程中
即使在静态链接中，整个libc.a文件并没有全部装入可执行文件中，所装入的只是所需要的函数！
## 动态链接的优点
* 动态链接相比静态链接可执行文件体积小。能节省磁盘空间和虚拟内存，因为函数库只有在需要的时候才被映射到进程。

* 所有动态链接到某特定函数库的可执行文件在运行时共享该函数库的一个单独拷贝。系统内核保证映射到内存的函数库
  可被所有使用它的进程共享.如果是静态链接将会有多份拷贝映射到内存，使消耗更多物理内存，引起更多换页。
>系统调用mmap()把文件映射到进程的地址空间。这样，文件的内容可以通过读取连续的内存地址来获得。

* 动态链接函数库版本升级方便，新函数库随时发布，只要安装到系统中，旧程序就可自动获得新函数库优点而不用重新链接
>使用共享函数库的主要原因是获得ABI(应用程序二进制接口)的好处--软件不必因新版本函数库或操作系统的发布而重新链接

* 动态链接库允许用户在运行时选择需要执行的函数库，根据自己的需求在程序执行时用一个库代替另一个库文件。
>任何人都可以创建静态或动态函数库。只需简单编译一些不含main()的代码，并把编译生成的.o文件用正确的工具处理
 ————静态库使用”ar“(.a扩展名，archive)<br/>————动态库使用”ld“(.so扩展名，shared libraries)
动态链接库可以用-G来创建：
`cc -o libfruit.so -G tomato.c`
然后利用这个库编写程序，并且使用以下方法链接：
`cc test.c -L/home/linden -R/home/lindeb -lfruit            //是字母’l‘，不是数字’1‘`
-L和-R是分别告诉链接器在”链接“时和”运行“时需要从哪个目录寻找链接的函数库
